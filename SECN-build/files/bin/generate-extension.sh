#!/bin/sh

echo "; 1,2 or 3 digit dialling of last octet" > /etc/asterisk/lastoctet.extensions.conf
echo "; The following lines are generated by the script /bin/generate-extension.sh" >> /etc/asterisk/lastoctet.extensions.conf
echo "; Do not edit, this file will be automatically overwritten when you reboot the device." >> /etc/asterisk/lastoctet.extensions.conf

OCTET123=`uci show network.lan.ipaddr | cut -d = -f 2 | cut -d . -f 1,2,3`.\${EXTEN}\)

echo " " >> /etc/asterisk/lastoctet.extensions.conf
echo "exten => _X,1,Dial(SIP/4000@"$OCTET123 >>  /etc/asterisk/lastoctet.extensions.conf
echo "exten => _XX,1,Dial(SIP/4000@"$OCTET123 >>  /etc/asterisk/lastoctet.extensions.conf
echo "exten => _XXX,1,Dial(SIP/4000@"$OCTET123 >>  /etc/asterisk/lastoctet.extensions.conf


